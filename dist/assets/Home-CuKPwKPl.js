import{D as V,C as g}from"./index-BxJgwICe.js";import{U as O,d as ue}from"./index-BakwFiFG.js";/* empty css                   */import{d as H,r as M,a as i,o as I,c as B,b as l,w as o,e as j,u as e,t as S,F as K,f as T,g as r,i as L,E as G,h as z,j as de,k as Z,p as fe,l as be,_ as ve,m as ie,n as X,q as Q,v as W}from"./index-QU_Iccmb.js";const ye={class:"f-c-c w-100%"},ge=r("div",{class:"i-tabler-trash"},null,-1),xe=r("div",{class:"i-tabler-x"},null,-1),De=H({__name:"DeleteItem",props:{database:{type:Object},data:{type:Object,required:!0},value:{type:Object,required:!0},currY:{type:String,required:!0},currM:{type:String,required:!0},index:{type:Number,required:!0}},setup(f){const b=f,p=M(!1);async function _(){const{data:n,currM:a,value:s,database:t,currY:c}=b,w=n.items[a].balance,C=w.findIndex(h=>h.id===s.id);C!==-1?(w.splice(C,1),await V.put(t,g.DB_RECORD,O.Objects.raw(n),c),p.value=!p.value):G.error("未找到更新的收支项")}return(n,a)=>{const s=i("el-button"),t=i("el-form-item"),c=i("el-date-picker"),w=i("el-radio"),C=i("el-radio-group"),h=i("el-form"),N=i("el-dialog");return I(),B("div",null,[l(s,{size:"small",text:"",type:"danger",onClick:a[0]||(a[0]=D=>p.value=!e(p))},{default:o(()=>[j(" 删除收支 ")]),_:1}),l(N,{modelValue:e(p),"onUpdate:modelValue":a[4]||(a[4]=D=>L(p)?p.value=D:null),"append-to-body":"",title:"删除收支提示",width:"90%"},{default:o(()=>[l(h,{ref:"formInst","hide-required-asterisk":"","label-position":"left","label-width":"auto","status-icon":""},{default:o(()=>[l(t,{label:"备注",prop:"text"},{default:o(()=>[j(S(f.data.items[f.currM].balance[f.index].text),1)]),_:1}),l(t,{label:"金额",prop:"cost"},{default:o(()=>[j(S(f.data.items[f.currM].balance[f.index].cost),1)]),_:1}),l(t,{label:"日期时间",prop:"datetime"},{default:o(()=>[l(c,{modelValue:f.data.items[f.currM].balance[f.index].datetime,"onUpdate:modelValue":a[1]||(a[1]=D=>f.data.items[f.currM].balance[f.index].datetime=D),disabled:"",placeholder:"请输入日期时间",style:{width:"100%"},type:"date"},null,8,["modelValue"])]),_:1}),l(t,{label:"类型",prop:"type"},{default:o(()=>[l(C,{modelValue:f.data.items[f.currM].balance[f.index].type,"onUpdate:modelValue":a[2]||(a[2]=D=>f.data.items[f.currM].balance[f.index].type=D)},{default:o(()=>[(I(),B(K,null,T(["支","收"],D=>l(w,{label:D,value:D,disabled:""},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(t,{class:"mt-10"},{default:o(()=>[r("div",ye,[l(s,{class:"mr-4",plain:"",round:"",type:"danger",onClick:_},{icon:o(()=>[ge]),_:1}),l(s,{plain:"",round:"",type:"primary",onClick:a[3]||(a[3]=D=>p.value=!e(p))},{icon:o(()=>[xe]),_:1})])]),_:1})]),_:1},512)]),_:1},8,["modelValue"])])}}}),Ce={class:"f-c-c w-100%"},he=r("div",{class:"i-tabler-x"},null,-1),Ve=r("div",{class:"i-tabler-check"},null,-1),Oe=H({__name:"UpdateItem",props:{database:{type:Object},data:{type:Object,required:!0},value:{type:Object,required:!0},index:{type:Number,required:!0},currM:{type:String,required:!0},currY:{type:String,required:!0}},async setup(f){let b,p;const _=f,n=M(!1),a=M(),s=M({cost:[{validator:O.Forms.validateMoney,trigger:"change"}],text:[{required:!0,message:"请输入收支备注",trigger:"blur"},{min:1,max:50,message:"长度在1~50个字符之间",trigger:"blur"}],datetime:[{required:!0,message:"请输入日期时间",trigger:"change"}]}),t=M({..._.value}),{items:c}=([b,p]=z(()=>V.get(_.database,g.DB_COMMENTS,g.DB_KEY_COMMENTS)),b=await b,p(),b),w=M(c),C=(u,d)=>{const k=u?w.value.filter(O.createFilter(u)):w.value;d(k)};function h(u){t.value.cost=u.cost}function N(){t.value={..._.value},n.value=!n.value}function D(){const{data:u,currM:d,database:k,currY:Y}=_,{formValidator:R}=O.Forms,{id:U}=t.value,$=u.items[d].balance;R(a.value,async()=>{const x=$.findIndex(v=>v.id===U);x!==-1?($[x]=t.value,await V.put(k,g.DB_RECORD,O.Objects.raw(u),Y),n.value=!n.value):G.error("未找到更新的收支项")},()=>{G.error("检查输入的值是否正确")})}return(u,d)=>{const k=i("el-button"),Y=i("el-autocomplete"),R=i("el-form-item"),U=i("el-input"),$=i("el-date-picker"),x=i("el-radio"),v=i("el-radio-group"),y=i("el-form"),F=i("el-dialog");return I(),B("div",null,[l(k,{size:"small",text:"",type:"primary",onClick:N},{default:o(()=>[j("编辑收支")]),_:1}),l(F,{modelValue:e(n),"onUpdate:modelValue":d[5]||(d[5]=m=>L(n)?n.value=m:null),"append-to-body":"",title:"修改支出项",width:"90%"},{default:o(()=>[l(y,{ref_key:"formInst",ref:a,model:e(t),rules:e(s),"hide-required-asterisk":"","label-position":"left","label-width":"auto","status-icon":""},{default:o(()=>[l(R,{label:"备注",prop:"text"},{default:o(()=>[l(Y,{modelValue:e(t).text,"onUpdate:modelValue":d[0]||(d[0]=m=>e(t).text=m),"fetch-suggestions":C,"prefix-icon":e(de),placeholder:"请输入收支备注",style:{width:"100%"},onSelect:h},null,8,["modelValue","prefix-icon"])]),_:1}),l(R,{label:"花费",prop:"cost"},{default:o(()=>[l(U,{modelValue:e(t).cost,"onUpdate:modelValue":d[1]||(d[1]=m=>e(t).cost=m),modelModifiers:{number:!0},"prefix-icon":e(Z),placeholder:"请输入收支金额",type:"number"},null,8,["modelValue","prefix-icon"])]),_:1}),l(R,{label:"日期时间",prop:"datetime"},{default:o(()=>[l($,{modelValue:e(t).datetime,"onUpdate:modelValue":d[2]||(d[2]=m=>e(t).datetime=m),"disabled-date":m=>e(ue)(m,f.currY,f.currM),placeholder:"请输入日期时间",style:{width:"100%"},type:"date"},null,8,["modelValue","disabled-date"])]),_:1}),l(R,{label:"类型",prop:"type"},{default:o(()=>[l(v,{modelValue:e(t).type,"onUpdate:modelValue":d[3]||(d[3]=m=>e(t).type=m)},{default:o(()=>[(I(),B(K,null,T(["支","收"],m=>l(x,{value:m},{default:o(()=>[j(S(m),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(R,{class:"mt-10"},{default:o(()=>[r("div",Ce,[l(k,{class:"mr-4",plain:"",round:"",onClick:d[4]||(d[4]=m=>n.value=!e(n))},{icon:o(()=>[he]),_:1}),l(k,{plain:"",round:"",type:"primary",onClick:D},{icon:o(()=>[Ve]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),ce=f=>(fe("data-v-1ccfdec8"),f=f(),be(),f),we={class:"f-c-c w-100%"},ke=ce(()=>r("div",{class:"i-tabler-x"},null,-1)),Me=ce(()=>r("div",{class:"i-tabler-check"},null,-1)),Ye=H({__name:"AddItem",props:{database:{type:Object},data:{type:Object,required:!0},currY:{type:String,required:!0},currM:{type:String,required:!0}},async setup(f){let b,p;const _=f,n=M(!1),a=M({id:"",cost:0,text:"",type:"支",datetime:O.Dates.nowDate("YY-MM-DD",new Date(Number(_.currY),Number(_.currM)-1))}),s=M(),t=M({cost:[{validator:O.Forms.validateMoney,trigger:"change"}],text:[{required:!0,message:"请输入收支备注",trigger:"change"},{min:1,max:50,message:"长度在1~50个字符之间",trigger:"change"}],datetime:[{required:!0,message:"请输入日期时间",trigger:"change"}]}),{items:c}=([b,p]=z(()=>V.get(_.database,g.DB_COMMENTS,g.DB_KEY_COMMENTS)),b=await b,p(),b),w=M(c);function C(){const{data:u,currM:d,database:k,currY:Y}=_,{formValidator:R}=O.Forms,{generateRandomHash:U,Objects:$}=O,{value:x}=s,{value:v}=n;R(x,async()=>{a.value.id=U(),u.items[d].balance.push({...a.value}),await V.put(k,g.DB_RECORD,$.raw(u),Y),n.value=!v},()=>{G.error("检查输入的值是否正确")})}const h=(u,d)=>{const k=u?w.value.filter(O.createFilter(u)):w.value;d(k)};function N(u){a.value.text=u.value,a.value.cost=u.cost,a.value.type=u.type}function D(){s.value.resetFields(),a.value.datetime=O.Dates.nowDate("YY-MM-DD",new Date(Number(_.currY),Number(_.currM)-1))}return(u,d)=>{const k=i("el-button"),Y=i("el-autocomplete"),R=i("el-form-item"),U=i("el-input"),$=i("el-date-picker"),x=i("el-radio"),v=i("el-radio-group"),y=i("el-form"),F=i("el-dialog");return I(),B("div",null,[l(k,{plain:"",round:"",size:"small",type:"success",onClick:d[0]||(d[0]=m=>n.value=!e(n))},{default:o(()=>[j("添加收支")]),_:1}),l(F,{modelValue:e(n),"onUpdate:modelValue":d[6]||(d[6]=m=>L(n)?n.value=m:null),"append-to-body":"",title:"添加收支",width:"90%",onOpened:D},{default:o(()=>[l(y,{ref_key:"formInst",ref:s,model:e(a),rules:e(t),"hide-required-asterisk":"","label-position":"left","label-width":"auto","status-icon":""},{default:o(()=>[l(R,{label:"备注",prop:"text"},{default:o(()=>[l(Y,{modelValue:e(a).text,"onUpdate:modelValue":d[1]||(d[1]=m=>e(a).text=m),"fetch-suggestions":h,"prefix-icon":e(de),placeholder:"请输入收支备注",style:{width:"100%"},onSelect:N},null,8,["modelValue","prefix-icon"])]),_:1}),l(R,{label:"花费",prop:"cost"},{default:o(()=>[l(U,{modelValue:e(a).cost,"onUpdate:modelValue":d[2]||(d[2]=m=>e(a).cost=m),"prefix-icon":e(Z),placeholder:"请输入收支金额",type:"number"},null,8,["modelValue","prefix-icon"])]),_:1}),l(R,{label:"日期时间",prop:"datetime"},{default:o(()=>[l($,{modelValue:e(a).datetime,"onUpdate:modelValue":d[3]||(d[3]=m=>e(a).datetime=m),"disabled-date":m=>e(ue)(m,f.currY,f.currM),placeholder:"请输入日期时间",style:{width:"100%"},type:"date"},null,8,["modelValue","disabled-date"])]),_:1}),l(R,{label:"类型",prop:"type"},{default:o(()=>[l(v,{modelValue:e(a).type,"onUpdate:modelValue":d[4]||(d[4]=m=>e(a).type=m)},{default:o(()=>[(I(),B(K,null,T(["支","收"],m=>l(x,{label:m,value:m},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(R,{class:"mt-10"},{default:o(()=>[r("div",we,[l(k,{class:"mr-4",plain:"",round:"",onClick:d[5]||(d[5]=m=>n.value=!e(n))},{icon:o(()=>[ke]),_:1}),l(k,{plain:"",round:"",type:"primary",onClick:C},{icon:o(()=>[Me]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Ie=ve(Ye,[["__scopeId","data-v-1ccfdec8"]]),Re={class:"f-c-c w-100%"},Ee=r("div",{class:"i-tabler-x"},null,-1),Be=r("div",{class:"i-tabler-check"},null,-1),Ne=H({__name:"UpdateRecord",props:{database:{type:Object,required:!0},data:{type:Object,required:!0},currM:{type:String,required:!0},currY:{type:String,required:!0}},setup(f){var c,w;const b=f,p=M(!1),_=M(),n=M({budget:[{validator:O.Forms.validateMoney,trigger:"change"}]}),a=ie({budget:((w=(c=b.data)==null?void 0:c.items[b.currM])==null?void 0:w.budget)||0});function s(){var C,h;a.budget=((h=(C=b.data)==null?void 0:C.items[b.currM])==null?void 0:h.budget)||0,p.value=!p.value}function t(){const{data:C,currM:h,database:N,currY:D}=b,{formValidator:u}=O.Forms,{budget:d}=a,{value:k}=_,{value:Y}=p;u(k,async()=>{C.items[h].budget=Number(d),await V.put(N,g.DB_RECORD,O.Objects.raw(C),D),p.value=!Y},()=>{G.error("检查输入的值是否正确")})}return(C,h)=>{const N=i("el-button"),D=i("el-input"),u=i("el-form-item"),d=i("el-form"),k=i("el-dialog");return I(),B("div",null,[l(N,{plain:"",round:"",size:"small",type:"info",onClick:s},{default:o(()=>[j("修改记录")]),_:1}),l(k,{modelValue:e(p),"onUpdate:modelValue":h[2]||(h[2]=Y=>L(p)?p.value=Y:null),"append-to-body":"",title:"修改记录",width:"90%"},{default:o(()=>[l(d,{ref_key:"formInst",ref:_,model:e(a),rules:e(n),"hide-required-asterisk":"","label-position":"left","status-icon":""},{default:o(()=>[l(u,{label:"预算",prop:"budget"},{default:o(()=>[l(D,{modelValue:e(a).budget,"onUpdate:modelValue":h[0]||(h[0]=Y=>e(a).budget=Y),"prefix-icon":e(Z),type:"number"},null,8,["modelValue","prefix-icon"])]),_:1}),l(u,{class:"mt-10"},{default:o(()=>[r("div",Re,[l(N,{class:"mr-4",plain:"",round:"",onClick:h[1]||(h[1]=Y=>p.value=!e(p))},{icon:o(()=>[Ee]),_:1}),l(N,{plain:"",round:"",type:"primary",onClick:t},{icon:o(()=>[Be]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Fe=r("div",{class:"i-tabler-calendar"},null,-1),qe={class:"f-c-c w-100%"},Se=r("div",{class:"i-tabler-x"},null,-1),$e=r("div",{class:"i-tabler-check"},null,-1),je=H({__name:"CreateRecord",props:{database:{type:Object},data:{type:Object,required:!0},currM:{type:String,required:!0},currY:{type:String,required:!0},mList:{type:Array,required:!0}},emits:["onCreated"],async setup(f,{emit:b}){let p,_;const n=f,a=b,s=([p,_]=z(()=>V.get(n.database,g.DB_CONFIG,g.DB_KEY_CONFIG)),p=await p,_(),p),t=M(!1),c=ie({year:n.currY,month:"1月",budget:s.budget}),w=M(),C=M();function h(){O.Forms.formValidator(w.value,()=>{const D=c.month.split("月")[0];c.year!=n.currY?V.get(n.database,g.DB_RECORD,c.year).then(u=>{u?Object.keys(u.items).includes(D)?G.error("已有该记录"):(u.items[D]={surplus:0,budget:c.budget,balance:[]},V.put(n.database,g.DB_RECORD,O.Objects.raw(u),n.currY).then(()=>{t.value=!t.value,a("onCreated",c.year)})):V.add(n.database,g.DB_RECORD,{id:c.year,items:{[D]:{budget:c.budget,surplus:0,balance:[]}}}).then(()=>{t.value=!t.value,a("onCreated",c.year)})}):n.mList.includes(D)?G.error("已有该记录"):(n.data.items[D]={surplus:0,budget:c.budget,balance:[]},V.put(n.database,g.DB_RECORD,O.Objects.raw(n.data),n.currY).then(()=>{t.value=!t.value,a("onCreated",c.year)}))},()=>G.error("创建记录失败"))}const N=Array.from({length:12},(D,u)=>({value:`${u+1}`,label:`${u+1}`}));return(D,u)=>{const d=i("el-button"),k=i("el-date-picker"),Y=i("el-form-item"),R=i("el-option"),U=i("el-select"),$=i("el-input"),x=i("el-form"),v=i("el-dialog");return I(),B("div",null,[l(d,{plain:"",round:"",size:"small",type:"primary",onClick:u[0]||(u[0]=y=>t.value=!e(t))},{default:o(()=>[j("创建记录")]),_:1}),l(v,{modelValue:e(t),"onUpdate:modelValue":u[5]||(u[5]=y=>L(t)?t.value=y:null),"append-to-body":"",title:"创建记录",width:"90%",onOpened:u[6]||(u[6]=y=>e(w).resetFields())},{default:o(()=>[l(x,{ref_key:"formInst",ref:w,model:e(c),rules:e(C),"hide-required-asterisk":"","label-position":"left","status-icon":""},{default:o(()=>[l(Y,{label:"年份",prop:"year"},{default:o(()=>[l(k,{modelValue:e(c).year,"onUpdate:modelValue":u[1]||(u[1]=y=>e(c).year=y),format:"YYYY",placeholder:"选择一个年份",style:{width:"100%"},type:"year","value-format":"YYYY"},null,8,["modelValue"])]),_:1}),l(Y,{label:"月份",prop:"month"},{default:o(()=>[l(U,{modelValue:e(c).month,"onUpdate:modelValue":u[2]||(u[2]=y=>e(c).month=y),class:"w-100%"},{prefix:o(()=>[Fe]),default:o(()=>[(I(!0),B(K,null,T(e(N),y=>(I(),X(R,{key:y.value,label:y.label+"月",value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(Y,{label:"预算",prop:"budget"},{default:o(()=>[l($,{modelValue:e(c).budget,"onUpdate:modelValue":u[3]||(u[3]=y=>e(c).budget=y),"prefix-icon":e(Z),type:"number"},null,8,["modelValue","prefix-icon"])]),_:1}),l(Y,{class:"mt-10"},{default:o(()=>[r("div",qe,[l(d,{class:"mr-4",plain:"",round:"",onClick:u[4]||(u[4]=y=>t.value=!e(t))},{icon:o(()=>[Se]),_:1}),l(d,{plain:"",round:"",type:"primary",onClick:h},{icon:o(()=>[$e]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Ue=H({__name:"DeleteRecord",props:{database:{type:Object},data:{type:Object,required:!0},currM:{type:String,required:!0},currY:{type:String,required:!0},mList:{type:Array,required:!0}},emits:["onDeleted"],setup(f,{emit:b}){const p=f,_=b;function n(){const{mList:a,currM:s,data:t,database:c,currY:w}=p,C=O.deleteAndReturnNext(a,s);C?(delete t.items[s],V.put(c,g.DB_RECORD,O.Objects.raw(t),w).then(()=>V.put(c,g.DB_CONFIG,{id:g.DB_KEY_CONFIG,Y:w,M:C},g.DB_KEY_CONFIG)).then(()=>_("onDeleted",C)).catch(h=>{G.error("删除记录时发生错误"),console.error(h)})):G.error("至少保留一条记录")}return(a,s)=>{const t=i("el-button"),c=i("el-popconfirm");return I(),B("div",null,[l(c,{"cancel-button-text":"取消","confirm-button-text":"确定",title:"确定删除该记录？",onConfirm:n},{reference:o(()=>[l(t,{plain:"",round:"",size:"small",type:"danger"},{default:o(()=>[j("删除记录")]),_:1})]),_:1})])}}}),Ge={class:"main"},Ae={class:"mb-4"},Ke=r("div",{class:"mb-2"},"日期",-1),Te={class:"f-c-b"},ze={class:"mb-4"},Le=r("div",{class:"mb-2"},"操作",-1),He={class:"f-c-b"},Je={class:"mb-4"},Pe=r("div",{class:"mb-2"},"数据",-1),Qe={class:"f-c-s text-text-regular text-0.8rem"},We={class:"f-c-c"},Xe=r("div",{class:"i-tabler-coin text-text-secondary mr-1"},null,-1),Ze=r("span",{class:"text-text-secondary mr-1"},"预算",-1),et=r("span",{class:"text-text-secondary mr-1"},"，剩余",-1),tt={class:"f-c-e text-text-regular text-0.8rem"},lt={class:"f-c-c"},at=r("div",{class:"i-tabler-minus text-text-secondary mr-1"},null,-1),ot=r("span",{class:"text-text-secondary mr-1"},"支出",-1),nt=r("span",{class:"text-text-secondary mr-1"},"，增长",-1),rt={class:"f-c-c text-red"},st=r("div",{class:"i-tabler-caret-up"},null,-1),ut={class:"f-c-c text-green"},dt=r("div",{class:"i-tabler-caret-down"},null,-1),it={class:"mb-2 text-0.9rem text-text-secondary"},ct={class:"w-100% f-c-b"},mt={class:"f-c-s"},pt={class:"text-text-secondary"},_t={class:"m-2"},gt=H({__name:"Home",async setup(f){let b,p;const _=([b,p]=z(()=>V.create()),b=await b,p(),b),n=([b,p]=z(()=>V.get(_,g.DB_CONFIG,g.DB_KEY_CONFIG)),b=await b,p(),b),a=M(n.Y),s=M(n.M),t=M(([b,p]=z(()=>V.get(_,g.DB_RECORD,a.value)),b=await b,p(),b)),c=M(Object.keys(t.value.items)),w=M(([b,p]=z(()=>V.keys(_,g.DB_RECORD)),b=await b,p(),b)),C=M(0);function h(){if(!(t!=null&&t.value.items[s.value]))return 0;let x,v=0,y=0;const F=c.value.sort((E,A)=>Number(E)-Number(A)),m=F.findIndex(E=>E===s.value);return m!==-1?(m===0||(t.value.items[F[m-1]].balance.forEach(E=>v+=Number(E.cost)),t.value.items[F[m]].balance.forEach(E=>y+=Number(E.cost))),x=v!==0?(y-v)/v*100*10/10:0):x=0,x}function N(x){let v=0;return x.forEach(y=>{y.type==="收"?v-=Number(y.cost):v+=Number(y.cost)}),v}function D(){if(!(t!=null&&t.value.items[s.value]))return 0;const x=N(t.value.items[s.value].balance);return t.value.items[s.value].surplus=Number(t.value.items[s.value].budget-x),V.put(_,g.DB_RECORD,O.Objects.raw(t.value),a.value).then(()=>{C.value=h()}),t.value.items[s.value].surplus}function u(x){let v=0;return x.forEach(y=>{y.type==="支"&&(v+=Number(y.cost))}),v}function d(){return t!=null&&t.value.items[s.value]?u(t.value.items[s.value].balance):0}function k(){n.Y=a.value,n.M=s.value,V.put(_,g.DB_CONFIG,O.Objects.raw(n),g.DB_KEY_CONFIG),V.get(_,g.DB_RECORD,a.value).then(x=>{t.value=x,c.value=Object.keys(t.value.items),s.value=c.value[0]})}function Y(){n.Y=a.value,n.M=s.value,V.put(_,g.DB_CONFIG,O.Objects.raw(n),g.DB_KEY_CONFIG)}async function R(x){V.get(_,g.DB_RECORD,x).then(v=>{t.value=v,V.keys(_,g.DB_RECORD).then(y=>{w.value=y,a.value=x,c.value=Object.keys(t.value.items),s.value=c.value[0],n.Y=a.value,n.M=s.value,V.put(_,g.DB_CONFIG,O.Objects.raw(n),g.DB_KEY_CONFIG)})})}function U(x){s.value=x,n.Y=a.value,n.M=s.value,V.put(_,g.DB_CONFIG,O.Objects.raw(n),g.DB_KEY_CONFIG)}function $(x){var P;const v={};(((P=x==null?void 0:x.items[s.value])==null?void 0:P.balance)||[]).forEach(E=>{const A=O.Dates.formatDate("YY-MM-DD HH:mm:ss",String(E.datetime)).split(" ")[0];v[A]||(v[A]=[]),v[A].push(E)});const F={},m=Object.keys(v).sort((E,A)=>new Date(E).getTime()-new Date(A).getTime());return n.itemAsc||m.reverse(),m.forEach(E=>{F[E]=v[E]}),F}return(x,v)=>{var te,le,ae,oe,ne,re;const y=i("el-option"),F=i("el-select"),m=je,P=Ne,E=Ie,A=i("el-tag"),me=Oe,pe=De,_e=i("el-dropdown");return I(),B("div",Ge,[r("div",Ae,[Ke,r("div",Te,[l(F,{modelValue:e(a),"onUpdate:modelValue":v[0]||(v[0]=q=>L(a)?a.value=q:null),class:"mr-4",onChange:k},{default:o(()=>[(I(!0),B(K,null,T(e(w),q=>(I(),X(y,{key:q,label:q+"年",value:q},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(F,{modelValue:e(s),"onUpdate:modelValue":v[1]||(v[1]=q=>L(s)?s.value=q:null),onChange:Y},{default:o(()=>[(I(!0),B(K,null,T(e(c),q=>(I(),X(y,{key:q+"月",label:q+"月",value:q},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),r("div",ze,[Le,r("div",He,[l(Ue,{"curr-m":e(s),"curr-y":e(a),data:e(t),database:e(_),"m-list":e(c),onOnDeleted:U},null,8,["curr-m","curr-y","data","database","m-list"]),l(m,{"curr-m":e(s),"curr-y":e(a),data:e(t),database:e(_),"m-list":e(c),onOnCreated:R},null,8,["curr-m","curr-y","data","database","m-list"]),l(P,{"curr-m":e(s),"curr-y":e(a),data:e(t),database:e(_)},null,8,["curr-m","curr-y","data","database"]),l(E,{"curr-m":e(s),"curr-y":e(a),data:e(t),database:e(_)},null,8,["curr-m","curr-y","data","database"])])]),r("div",null,[r("div",Je,[Pe,r("div",Qe,[r("div",We,[Xe,Ze,r("span",null,S((le=(te=e(t))==null?void 0:te.items[e(s)])==null?void 0:le.budget),1),et,Q(r("span",{class:"text-green"},S(D().toFixed(2)),513),[[W,((oe=(ae=e(t))==null?void 0:ae.items[e(s)])==null?void 0:oe.surplus)>=0]]),Q(r("span",{class:"text-red"},S(D().toFixed(2)),513),[[W,((re=(ne=e(t))==null?void 0:ne.items[e(s)])==null?void 0:re.surplus)<0]])])]),r("div",tt,[r("div",lt,[at,ot,r("span",null,S(d().toFixed(2)),1)]),nt,Q(r("div",rt,[j(S(e(C).toFixed(2))+"% ",1),st],512),[[W,e(C)>0]]),Q(r("div",ut,[j(S(e(C).toFixed(2))+"% ",1),dt],512),[[W,e(C)<=0]])])]),r("div",null,[(I(!0),B(K,null,T($(e(t)),(q,se)=>(I(),B("div",{key:se,class:"mb-4"},[r("div",it,S(se),1),(I(!0),B(K,null,T(q,(J,ee)=>(I(),X(_e,{key:ee,class:"w-100% bg-bg-overlay p-4 rd-2 mt-2",trigger:"click"},{dropdown:o(()=>[r("div",_t,[l(me,{"curr-m":e(s),"curr-y":e(a),data:e(t),database:e(_),index:ee,value:J,class:"mb-2"},null,8,["curr-m","curr-y","data","database","index","value"]),l(pe,{"curr-m":e(s),"curr-y":e(a),data:e(t),database:e(_),index:ee,value:J},null,8,["curr-m","curr-y","data","database","index","value"])])]),default:o(()=>[r("div",ct,[r("div",mt,[l(A,{type:J.type=="支"?"danger":"success",class:"mr-4",size:"small"},{default:o(()=>[j(S(J.type),1)]),_:2},1032,["type"]),r("div",null,S(J.text),1)]),r("div",pt,S(J.cost),1)])]),_:2},1024))),128))]))),128))])])])}}});export{gt as default};
