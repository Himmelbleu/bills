import{D as e,C as t}from"./index-XVv16cgR.js";import{U as h}from"./index-GWoM0CYy.js";import{d as E,n as C,c as y,g as c,b as d,w as _,a as p,o as D,e as f}from"./index-nbPqKYAw.js";const g=c("div",{class:"mb-5"},[c("div",null,"设置"),c("div",{class:"text-0.8rem text-text-secondary"},"一些设置和管理")],-1),O={class:"flex-wrap f-c-b"},R={class:"f-c-c flex-basis-33.33% max-w-33.33%"},T={class:"f-c-c flex-basis-33.33% max-w-33.33%"},I=E({__name:"Settings",async setup(v){let m,u;const a=([m,u]=C(()=>e.create()),m=await m,u(),m);async function w(){const l=await e.get(a,t.RECORD),s=await e.get(a,t.COMMENTS,"0"),o=await e.get(a,t.VIEW_DATE,"0"),r=new Blob([JSON.stringify([{records:l,comments:s,datetime:o}])],{type:"text/json"}),i=document.createElement("a"),n=h.Dates.generateDate();i.download=`${n.y}-${n.m}-${n.d}${n.h}${n.minute}${n.second}.json`,i.href=URL.createObjectURL(r),i.click()}const x=async l=>{if(l.raw){const s=new FileReader;s.readAsText(l.raw),s.onload=()=>{const o=JSON.parse(s.result.toString());e.clear(a,t.RECORD).then(()=>{o[0].records.forEach(r=>{e.leadIn(a,r,t.RECORD)})}),e.clear(a,t.COMMENTS).then(()=>{e.leadIn(a,o[0].comments,t.COMMENTS)}),e.clear(a,t.VIEW_DATE).then(()=>{e.leadIn(a,o[0].datetime,t.VIEW_DATE)})}}};async function b(){await w(),await e.del(t.TALLY_PAD)}return(l,s)=>{const o=p("el-button"),r=p("el-upload"),i=p("el-popconfirm");return D(),y("div",null,[g,c("div",O,[c("div",R,[d(o,{plain:"",round:"",type:"primary",onClick:w},{default:_(()=>[f("导出数据")]),_:1})]),d(r,{class:"f-c-c flex-basis-33.33% max-w-33.33%",accept:"application/json","auto-upload":!1,limit:1,"on-change":x,"show-file-list":!1},{default:_(()=>[d(o,{plain:"",round:"",type:"success"},{default:_(()=>[f("导入数据")]),_:1})]),_:1}),c("div",T,[d(i,{title:"确定清除数据？",onConfirm:b},{reference:_(()=>[d(o,{plain:"",round:"",type:"danger"},{default:_(()=>[f("清除数据")]),_:1})]),_:1})])])])}}});export{I as default};
