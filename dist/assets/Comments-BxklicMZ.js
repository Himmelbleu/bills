import{d as Y,g as D,r as v,c as z,f as o,b as l,w as s,u as n,i as B,a as f,o as A,s as N,e as O,t as G,h as H,j as J,E as x}from"./index-D6eo5SNi.js";import{D as C,C as _}from"./index-BQ4MH4yd.js";import{U as p}from"./index-yN6PRDud.js";/* empty css                   */const L=o("div",{class:"mb-4"},[o("div",null,"快捷备注"),o("div",{class:"text-0.8rem text-text-secondary"},"快捷备注便于快速填写计划项。")],-1),P={class:"mb-4 f-c-e"},Q=o("div",{class:"i-tabler-plus"},null,-1),W={class:"f-c-b flex-gap-1 flex-wrap"},X={class:"f-c-b"},Z=o("div",{class:"i-tabler-trash"},null,-1),ee=o("div",{class:"i-tabler-edit"},null,-1),te={class:"text-red"},le={class:"f-c-c"},oe=o("div",{class:"i-tabler-trash"},null,-1),ae=o("div",{class:"i-tabler-x"},null,-1),se={class:"f-c-c"},ne=o("div",{class:"i-tabler-x"},null,-1),ie=o("div",{class:"i-tabler-check"},null,-1),ve=Y({__name:"Comments",async setup(re){let c,y;const g=([c,y]=D(()=>C.create()),c=await c,y(),c),d=v(([c,y]=D(()=>C.get(g,_.DB_COMMENTS,_.DB_KEY_COMMENTS)),c=await c,y(),c)),b=v(),m=v(!1),h=v("新增"),r=v(!1),M=v(),T=v({text:[{required:!0,message:"输入备注！",trigger:"change"},{required:!0,message:"输入备注！",trigger:"blur"}],cost:[{required:!0,validator:p.Forms.validateMoney,trigger:"change"},{required:!0,validator:p.Forms.validateMoney,trigger:"blur"}]}),e=v({text:"",cost:100,type:"支"});function S(){p.Forms.formValidator(M.value,()=>{const a=d.value.items.filter(p.createFilter(e.value.text));!a||a.length==0&&e.value.text?(d.value.items.push({value:e.value.text,cost:e.value.cost,type:e.value.type}),C.put(g,_.DB_COMMENTS,p.Objects.raw(d.value),_.DB_KEY_COMMENTS),r.value=!r.value):x.error("重复添加！")},()=>{x.error("检查输入的值是否正确")})}function I(){var t;const a=(t=d.value.items)==null?void 0:t.findIndex(u=>u.value===b.value.value);a>=0?p.Forms.formValidator(M.value,()=>{d.value.items[a]={value:e.value.text,cost:e.value.cost,type:e.value.type},C.put(g,_.DB_COMMENTS,p.Objects.raw(d.value),_.DB_KEY_COMMENTS),r.value=!r.value,e.value.value="",e.value.cost=100,e.value.type="支"},()=>{x.error("检查输入的值是否正确")}):x.error("更新失败")}function U(){var t;const a=(t=d.value.items)==null?void 0:t.findIndex(u=>u.value===b.value.value);a>=0?(d.value.items.splice(a,1),C.put(g,_.DB_COMMENTS,p.Objects.raw(d.value),_.DB_KEY_COMMENTS),m.value=!m.value):x.error("删除失败")}function q(a){b.value=a,m.value=!m.value}function F(a){h.value="更新",b.value=a,e.value.text=a.value,e.value.cost=a.cost,e.value.type=a.type,r.value=!r.value}function $(){h.value="新增",e.value.text="",e.value.cost=100,e.value.type="支",r.value=!r.value}return(a,t)=>{const u=f("el-button"),k=f("el-table-column"),j=f("el-table"),E=f("el-dialog"),V=f("el-input"),w=f("el-form-item"),K=f("el-form");return A(),z("div",null,[L,o("div",P,[l(u,{plain:"",round:"",size:"small",type:"primary",onClick:$},{icon:s(()=>[Q]),_:1})]),o("div",W,[l(j,{data:n(d).items,border:"",stripe:""},{default:s(()=>[l(k,{fixed:"left",label:"备注",prop:"value"}),l(k,{label:"金额",prop:"cost",sortable:""}),l(k,{fixed:"right",label:"操作",width:"90"},{default:s(i=>[o("div",X,[l(u,{link:"",size:"small",type:"danger",onClick:N(R=>q(i.row),["prevent"])},{icon:s(()=>[Z]),_:2},1032,["onClick"]),l(u,{link:"",size:"small",type:"success",onClick:N(R=>F(i.row),["prevent"])},{icon:s(()=>[ee]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),l(E,{modelValue:n(m),"onUpdate:modelValue":t[1]||(t[1]=i=>B(m)?m.value=i:null),"append-to-body":"",title:"消息提示",width:"90%"},{footer:s(()=>[o("div",le,[l(u,{class:"mr-4",plain:"",round:"",type:"danger",onClick:U},{icon:s(()=>[oe]),_:1}),l(u,{plain:"",round:"",type:"primary",onClick:t[0]||(t[0]=i=>m.value=!1)},{icon:s(()=>[ae]),_:1})])]),default:s(()=>[o("div",null,[O(" 是否要删除 "),o("span",te,G(n(b).value),1),O(" 备注？ ")])]),_:1},8,["modelValue"]),l(E,{modelValue:n(r),"onUpdate:modelValue":t[6]||(t[6]=i=>B(r)?r.value=i:null),title:n(h)=="新增"?"新建备注":"修改备注",width:"90%"},{footer:s(()=>[o("div",se,[l(u,{class:"mr-4",plain:"",round:"",onClick:t[4]||(t[4]=i=>r.value=!1)},{icon:s(()=>[ne]),_:1}),l(u,{plain:"",round:"",type:"primary",onClick:t[5]||(t[5]=i=>n(h)=="新增"?S():I())},{icon:s(()=>[ie]),_:1})])]),default:s(()=>[l(K,{ref_key:"formInst",ref:M,model:n(e),rules:n(T),"hide-required-asterisk":"","label-position":"left","status-icon":""},{default:s(()=>[l(w,{label:"备注",prop:"text"},{default:s(()=>[l(V,{modelValue:n(e).text,"onUpdate:modelValue":t[2]||(t[2]=i=>n(e).text=i),"prefix-icon":n(H),placeholder:"请输入备注"},null,8,["modelValue","prefix-icon"])]),_:1}),l(w,{label:"金额",prop:"cost"},{default:s(()=>[l(V,{modelValue:n(e).cost,"onUpdate:modelValue":t[3]||(t[3]=i=>n(e).cost=i),"prefix-icon":n(J),placeholder:"请输入金额"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{ve as default};
