import{d as Q,m as U,f as p,c as q,a as n,b as l,w as s,u as r,i as D,r as c,o as F,p as N,e as M,t as O,j as W,k as X,F as Y,g as Z,E as b}from"./index-EDEh1zGx.js";import{U as f,D as x,C as V}from"./el-message-UfdE36oZ.js";const ee={class:"f-c-s"},te=n("div",{class:"my-5"},[n("div",null,"我的备注"),n("div",{class:"text-0.8rem text-text-secondary"},"红色代表支出，绿色代表收入")],-1),le={class:"mb-5 f-c-e"},ae=n("div",{class:"i-tabler-plus"},null,-1),oe={class:"f-c-b flex-gap-1 flex-wrap"},se=n("div",{class:"i-tabler-trash"},null,-1),ne=n("div",{class:"i-tabler-edit"},null,-1),re={class:"text-red"},ie={class:"f-c-c"},ue=n("div",{class:"i-tabler-trash"},null,-1),de=n("div",{class:"i-tabler-x"},null,-1),ce={class:"f-c-c"},me=n("div",{class:"i-tabler-x"},null,-1),ve=n("div",{class:"i-tabler-check"},null,-1),be=Q({__name:"Comments",async setup(pe){let m,g;const y=([m,g]=U(()=>x.create()),m=await m,g(),m),d=p(([m,g]=U(()=>x.get(y,V.COMMENTS,"0")),m=await m,g(),m)),_=p(),v=p(!1),C=p("新增"),i=p(!1),$=a=>e=>e.value.includes(a),k=p(),I=p({text:[{required:!0,message:"输入备注！",trigger:"change"},{required:!0,message:"输入备注！",trigger:"blur"}],cost:[{required:!0,validator:f.Forms.validateMoney,trigger:"change"},{required:!0,validator:f.Forms.validateMoney,trigger:"blur"}],type:[{required:!0,message:"输入收支类型！",trigger:"change"},{required:!0,message:"输入收支类型！",trigger:"blur"}]}),t=p({text:"",cost:100,type:"支"});function S(){f.Forms.formValidator(k.value,()=>{const a=d.value.items.filter($(t.value.text));!a||a.length==0&&t.value.text?(d.value.items.push({value:t.value.text,cost:t.value.cost,type:t.value.type}),x.put(y,V.COMMENTS,f.Objects.raw(d.value),"0"),i.value=!i.value):b.error("重复添加！")},()=>{b.error("检查输入的值是否正确")})}function j(){var e;const a=(e=d.value.items)==null?void 0:e.findIndex(u=>u.value===_.value.value);a>=0?f.Forms.formValidator(k.value,()=>{d.value.items[a]={value:t.value.text,cost:t.value.cost,type:t.value.type},x.put(y,V.COMMENTS,f.Objects.raw(d.value),"0"),i.value=!i.value,t.value.value="",t.value.cost=100,t.value.type="支"},()=>{b.error("检查输入的值是否正确")}):b.error("更新失败")}function R(){var e;const a=(e=d.value.items)==null?void 0:e.findIndex(u=>u.value===_.value.value);a>=0?(d.value.items.splice(a,1),x.put(y,V.COMMENTS,f.Objects.raw(d.value),"0"),v.value=!v.value):b.error("删除失败")}const z=(a,e)=>e.type===a;function B(a){_.value=a,v.value=!v.value}function A(a){C.value="更新",_.value=a,t.value.text=a.value,t.value.cost=a.cost,t.value.type=a.type,i.value=!i.value}function L(){C.value="新增",t.value.text="",t.value.cost=100,t.value.type="支",i.value=!i.value}return(a,e)=>{const u=c("el-button"),h=c("el-table-column"),G=c("el-table"),E=c("el-dialog"),T=c("el-input"),w=c("el-form-item"),H=c("el-radio"),J=c("el-radio-group"),K=c("el-form");return F(),q("div",null,[n("div",ee,[n("div",{class:"i-tabler-arrow-left",onClick:e[0]||(e[0]=o=>a.$router.push("/"))})]),te,n("div",le,[l(u,{plain:"",round:"",size:"small",type:"primary",onClick:L},{icon:s(()=>[ae]),_:1})]),n("div",oe,[l(G,{stripe:"",border:"",data:r(d).items},{default:s(()=>[l(h,{fixed:"left",prop:"value",label:"备注",width:"95"}),l(h,{prop:"type",label:"类型",filters:[{text:"支",value:"支"},{text:"收",value:"收"}],"filter-method":z}),l(h,{prop:"cost",sortable:"",label:"金额"}),l(h,{fixed:"right",label:"操作",width:"80"},{default:s(o=>[l(u,{link:"",type:"danger",size:"small",onClick:N(P=>B(o.row),["prevent"])},{icon:s(()=>[se]),_:2},1032,["onClick"]),l(u,{link:"",type:"success",size:"small",onClick:N(P=>A(o.row),["prevent"])},{icon:s(()=>[ne]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),l(E,{modelValue:r(v),"onUpdate:modelValue":e[2]||(e[2]=o=>D(v)?v.value=o:null),"append-to-body":"",title:"消息提示",width:"90%"},{footer:s(()=>[n("div",ie,[l(u,{class:"mr-4",plain:"",round:"",type:"danger",onClick:R},{icon:s(()=>[ue]),_:1}),l(u,{plain:"",round:"",type:"primary",onClick:e[1]||(e[1]=o=>v.value=!1)},{icon:s(()=>[de]),_:1})])]),default:s(()=>[n("div",null,[M(" 是否要删除 "),n("span",re,O(r(_).value),1),M(" 备注？ ")])]),_:1},8,["modelValue"]),l(E,{modelValue:r(i),"onUpdate:modelValue":e[8]||(e[8]=o=>D(i)?i.value=o:null),title:r(C)=="新增"?"新建备注":"修改备注",width:"90%"},{footer:s(()=>[n("div",ce,[l(u,{class:"mr-4",plain:"",round:"",onClick:e[6]||(e[6]=o=>i.value=!1)},{icon:s(()=>[me]),_:1}),l(u,{plain:"",round:"",type:"primary",onClick:e[7]||(e[7]=o=>r(C)=="新增"?S():j())},{icon:s(()=>[ve]),_:1})])]),default:s(()=>[l(K,{ref_key:"formInst",ref:k,model:r(t),rules:r(I),"hide-required-asterisk":"","label-position":"left","status-icon":""},{default:s(()=>[l(w,{label:"备注",prop:"text"},{default:s(()=>[l(T,{modelValue:r(t).text,"onUpdate:modelValue":e[3]||(e[3]=o=>r(t).text=o),"prefix-icon":r(W),placeholder:"请输入收支备注"},null,8,["modelValue","prefix-icon"])]),_:1}),l(w,{label:"金额",prop:"cost"},{default:s(()=>[l(T,{modelValue:r(t).cost,"onUpdate:modelValue":e[4]||(e[4]=o=>r(t).cost=o),"prefix-icon":r(X),placeholder:"请输入收支金额"},null,8,["modelValue","prefix-icon"])]),_:1}),l(w,{label:"类型",prop:"type"},{default:s(()=>[l(J,{modelValue:r(t).type,"onUpdate:modelValue":e[5]||(e[5]=o=>r(t).type=o)},{default:s(()=>[(F(),q(Y,null,Z(["支","收"],o=>l(H,{value:o},{default:s(()=>[M(O(o),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{be as default};
