import{d as P,l as U,f as p,c as q,a as n,b as l,w as s,u as r,i as D,r as c,o as F,p as N,e as M,t as O,j as Q,k as W,F as X,g as Y,E as b}from"./index-Cbp8YrJA.js";import{U as f,D as x,C as V}from"./el-message-rcn6-hBP.js";const Z={class:"f-c-s"},ee=n("div",{class:"my-5"},[n("div",null,"我的备注"),n("div",{class:"text-0.8rem text-text-secondary"},"红色代表支出，绿色代表收入")],-1),te={class:"mb-5 f-c-e"},le=n("div",{class:"i-tabler-plus"},null,-1),ae={class:"f-c-b flex-gap-1 flex-wrap"},oe=n("div",{class:"i-tabler-trash"},null,-1),se=n("div",{class:"i-tabler-edit"},null,-1),ne={class:"text-red"},re={class:"f-c-c"},ie=n("div",{class:"i-tabler-trash"},null,-1),ue=n("div",{class:"i-tabler-x"},null,-1),de={class:"f-c-c"},ce=n("div",{class:"i-tabler-x"},null,-1),me=n("div",{class:"i-tabler-check"},null,-1),_e=P({__name:"Comments",async setup(ve){let m,g;const y=([m,g]=U(()=>x.create()),m=await m,g(),m),d=p(([m,g]=U(()=>x.get(y,V.COMMENTS,"0")),m=await m,g(),m)),_=p(),v=p(!1),C=p("新增"),i=p(!1),k=p(),$=p({text:[{required:!0,message:"输入备注！",trigger:"change"},{required:!0,message:"输入备注！",trigger:"blur"}],cost:[{required:!0,validator:f.Forms.validateMoney,trigger:"change"},{required:!0,validator:f.Forms.validateMoney,trigger:"blur"}],type:[{required:!0,message:"输入收支类型！",trigger:"change"},{required:!0,message:"输入收支类型！",trigger:"blur"}]}),t=p({text:"",cost:100,type:"支"});function I(){f.Forms.formValidator(k.value,()=>{const a=d.value.items.filter(f.createFilter(t.value.text));!a||a.length==0&&t.value.text?(d.value.items.push({value:t.value.text,cost:t.value.cost,type:t.value.type}),x.put(y,V.COMMENTS,f.Objects.raw(d.value),"0"),i.value=!i.value):b.error("重复添加！")},()=>{b.error("检查输入的值是否正确")})}function S(){var e;const a=(e=d.value.items)==null?void 0:e.findIndex(u=>u.value===_.value.value);a>=0?f.Forms.formValidator(k.value,()=>{d.value.items[a]={value:t.value.text,cost:t.value.cost,type:t.value.type},x.put(y,V.COMMENTS,f.Objects.raw(d.value),"0"),i.value=!i.value,t.value.value="",t.value.cost=100,t.value.type="支"},()=>{b.error("检查输入的值是否正确")}):b.error("更新失败")}function j(){var e;const a=(e=d.value.items)==null?void 0:e.findIndex(u=>u.value===_.value.value);a>=0?(d.value.items.splice(a,1),x.put(y,V.COMMENTS,f.Objects.raw(d.value),"0"),v.value=!v.value):b.error("删除失败")}const R=(a,e)=>e.type===a;function z(a){_.value=a,v.value=!v.value}function B(a){C.value="更新",_.value=a,t.value.text=a.value,t.value.cost=a.cost,t.value.type=a.type,i.value=!i.value}function A(){C.value="新增",t.value.text="",t.value.cost=100,t.value.type="支",i.value=!i.value}return(a,e)=>{const u=c("el-button"),h=c("el-table-column"),L=c("el-table"),E=c("el-dialog"),T=c("el-input"),w=c("el-form-item"),G=c("el-radio"),H=c("el-radio-group"),J=c("el-form");return F(),q("div",null,[n("div",Z,[n("div",{class:"i-tabler-arrow-left",onClick:e[0]||(e[0]=o=>a.$router.push("/"))})]),ee,n("div",te,[l(u,{plain:"",round:"",size:"small",type:"primary",onClick:A},{icon:s(()=>[le]),_:1})]),n("div",ae,[l(L,{stripe:"",border:"",data:r(d).items},{default:s(()=>[l(h,{fixed:"left",prop:"value",label:"备注",width:"95"}),l(h,{prop:"type",label:"类型",filters:[{text:"支",value:"支"},{text:"收",value:"收"}],"filter-method":R}),l(h,{prop:"cost",sortable:"",label:"金额"}),l(h,{fixed:"right",label:"操作",width:"80"},{default:s(o=>[l(u,{link:"",type:"danger",size:"small",onClick:N(K=>z(o.row),["prevent"])},{icon:s(()=>[oe]),_:2},1032,["onClick"]),l(u,{link:"",type:"success",size:"small",onClick:N(K=>B(o.row),["prevent"])},{icon:s(()=>[se]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),l(E,{modelValue:r(v),"onUpdate:modelValue":e[2]||(e[2]=o=>D(v)?v.value=o:null),"append-to-body":"",title:"消息提示",width:"90%"},{footer:s(()=>[n("div",re,[l(u,{class:"mr-4",plain:"",round:"",type:"danger",onClick:j},{icon:s(()=>[ie]),_:1}),l(u,{plain:"",round:"",type:"primary",onClick:e[1]||(e[1]=o=>v.value=!1)},{icon:s(()=>[ue]),_:1})])]),default:s(()=>[n("div",null,[M(" 是否要删除 "),n("span",ne,O(r(_).value),1),M(" 备注？ ")])]),_:1},8,["modelValue"]),l(E,{modelValue:r(i),"onUpdate:modelValue":e[8]||(e[8]=o=>D(i)?i.value=o:null),title:r(C)=="新增"?"新建备注":"修改备注",width:"90%"},{footer:s(()=>[n("div",de,[l(u,{class:"mr-4",plain:"",round:"",onClick:e[6]||(e[6]=o=>i.value=!1)},{icon:s(()=>[ce]),_:1}),l(u,{plain:"",round:"",type:"primary",onClick:e[7]||(e[7]=o=>r(C)=="新增"?I():S())},{icon:s(()=>[me]),_:1})])]),default:s(()=>[l(J,{ref_key:"formInst",ref:k,model:r(t),rules:r($),"hide-required-asterisk":"","label-position":"left","status-icon":""},{default:s(()=>[l(w,{label:"备注",prop:"text"},{default:s(()=>[l(T,{modelValue:r(t).text,"onUpdate:modelValue":e[3]||(e[3]=o=>r(t).text=o),"prefix-icon":r(Q),placeholder:"请输入收支备注"},null,8,["modelValue","prefix-icon"])]),_:1}),l(w,{label:"金额",prop:"cost"},{default:s(()=>[l(T,{modelValue:r(t).cost,"onUpdate:modelValue":e[4]||(e[4]=o=>r(t).cost=o),"prefix-icon":r(W),placeholder:"请输入收支金额"},null,8,["modelValue","prefix-icon"])]),_:1}),l(w,{label:"类型",prop:"type"},{default:s(()=>[l(H,{modelValue:r(t).type,"onUpdate:modelValue":e[5]||(e[5]=o=>r(t).type=o)},{default:s(()=>[(F(),q(X,null,Y(["支","收"],o=>l(G,{value:o},{default:s(()=>[M(O(o),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{_e as default};
